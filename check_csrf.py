import requests

def check_csrf(url):
    csrf_token = ""
    response = requests.get(url)
    
    if "csrf_token" in response.text:
        csrf_token = response.text.split("csrf_token = ")[1].split(";")[0]
    
    if csrf_token:
        payloads = [
            {"csrf_token": csrf_token},    # Existing token payload
            {"csrf": csrf_token},          # Different key name for token payload
            {"csrf_token": "invalid"},     # Invalid token payload
         """   {"CSRFToken": csrf_token},     # Different capitalization for token payload
            {"csrf_token": csrf_token + "extra"},  # Additional characters in token payload
            {"csrf_token": csrf_token[:-1]},       # Truncated token payload
            {"csrf_token": csrf_token[::-1]},      # Reversed token payload
            {"csrf_token": csrf_token.upper()},    # Uppercase token payload
            {"csrf_token": csrf_token.lower()},    # Lowercase token payload
            {"csrf_token": ""}                      # Empty token payload
            # Add more payloads here to simulate different CSRF scenarios """
        ]
        
        for payload in payloads:
            response = requests.post(url, data=payload)
            if "Invalid CSRF token" not in response.text:
                return "CSRF vulnerability detected!", 3
    
    return "No CSRF vulnerability detected.", 1
    pass
